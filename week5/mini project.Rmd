---
title: "mini project"
author: "Cody"
date: "10/26/2021"
output: html_document
---

```{r}
setwd("~/Desktop")
fna.data <- read.csv("WisconsinCancer.csv")
fna.data
wisc.df <- data.frame(fna.data, row.names=1)
wisc.df
wisc.data <- wisc.df[,-1]
wisc.data
diagnosis <- as.factor(wisc.df$diagnosis)
```

**Q1. How many observations are in this dataset?**
```{r}
nrow(fna.data)
```
There are 569 observations in the data set, 32 observations per patient

**Q2. How many of the observations have a malignant diagnosis?**
```{r}
table(diagnosis)
```
There are 212 observations with a malignant diagnosis

**Q3. How many variables/features in the data are suffixed with _mean?**
```{r}
length(grep("_mean", colnames(wisc.data)))
```

There are 10 variables/features in the data set with the suffix "_mean"


**checking col means and standard deviations**
```{r}
colMeans(wisc.data)
apply(wisc.data,2,sd)

#PCA
wisc.pr <- prcomp(wisc.data, scale= TRUE, center=T)
summary(wisc.pr)
```

**Q4. From your results, what proportion of the original variance is captured by the first principal components (PC1)?**
44.27% of the variance is captured in the first principle components

**Q5. How many principal components (PCs) are required to describe at least 70% of the original variance in the data?**
```{r}
0.4427+0.1897+0.09393
```
PC's 1:3 are required to describe at least 70% of the original variance

**Q6. How many principal components (PCs) are required to describe at least 90% of the original variance in the data?**
```{r}
sum(0.4427,0.1897 ,0.09393, 0.06602 ,0.05496, 0.04025 ,0.02251)
```

the first 7 PCs are required to describe at least 90% of the original variance


**Q7. What stands out to you about this plot? Is it easy or difficult to understand? Why?**
it is shit

```{r}
biplot(wisc.pr)
```


**Q8. Generate a similar plot for principal components 1 and 3. What do you notice about these plots?**
```{r}
plot(wisc.pr$x [, c(1,2)], col = (diagnosis) , xlab = "PC1", ylab = "PC2")
plot(wisc.pr$x[,c(1,3)], col = diagnosis, xlab= "PC1", ylab = "PC3")
```

These plots are much more clear and easy to interpret


**Q9. For the first principal component, what is the component of the loading vector (i.e. wisc.pr$rotation[,1]) for the feature concave.points_mean?**

```{r}
wisc.pr$rotation[,1]
```
concave.points_mean = -0.26085376


**Q10. What is the minimum number of principal components required to explain 80% of the variance of the data?**
```{r}
sum(0.4427, 0.1897, 0.09393, 0.06602, 0.05496)
summary(wisc.pr)
```
The minimum number of principal components required to explain 80% of variance is 5.


```{r}
library(ggplot2)

df<- as.data.frame(wisc.pr$x)
df$diagnosis <- diagnosis

ggplot(df, aes(PC1, PC2, col= diagnosis)) +
         geom_point()
```




**variance**
```{r}
pr.var <- (wisc.pr$sdev)^2
head(pr.var)
pr.var

pve<- pr.var/sum(pr.var)

plot(pve, xlab = "Principal Component", 
     ylab = "Proportion of Variance Explained", 
     ylim = c(0, 1), type = "o")


barplot(pve, ylab = "Precent of Variance Explained",
     names.arg=paste0("PC",1:length(pve)), las=2, axes = FALSE)
axis(2, at=pve, labels=round(pve,2)*100 )
```




```{r}
install.packages("factoextra")
library(factoextra)
fviz_eig(wisc.pr, addlabels = TRUE)
```



**Hierarchical clustering**
```{r}
data.scaled <- scale(wisc.data)
data.dist <- dist(data.scaled)
wisc.hclust <- hclust(data.dist, method="complete")
```


**Q11. Using the plot() and abline() functions, what is the height at which the clustering model has 4 clusters?**
```{r}
plot.wisc <- plot(wisc.hclust)
abline(plot.wisc, col="red", lty=4)
unique(cutree(wisc.hclust, h=20))
```



```{r}
wisc.hclust.clusters <- cutree(wisc.hclust, k=4)
table(wisc.hclust.clusters, diagnosis)
```

**Q12. Can you find a better cluster vs diagnoses match by cutting into a different number of clusters between 2 and 10?**
